<!doctype html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<title>סימולטור פריסת מענק פרישה</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap');
  
  :root{
    --bg: #0A0A0A;
    --card: #1A1A1A;
    --primary: #4ADE80;
    --secondary: #2A366E;
    --text-primary: #EFEFEF;
    --text-secondary: #A3A3A3;
    --danger: #EF4444;
    --border: rgba(255, 255, 255, 0.1);
    --ring: rgba(74, 222, 128, 0.25);
  }
  *{
    box-sizing:border-box;
    font-family: 'Heebo', sans-serif;
  }
  html,body{height:100%}
  body{
    margin:0;
    background: var(--bg);
    color: var(--text-primary);
  }
  .container{
    max-width:1100px;
    margin:0 auto;
    padding:20px;
  }
  @media (max-width:768px){
    .container{padding:12px}
  }
  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-bottom:16px;
  }
  .brand{
    display:flex;
    align-items:center;
    gap:12px;
  }
  h1{
    font-size:1.8rem;
    font-weight: 700;
    margin:0 0 2px;
    line-height: 1.2;
  }
  @media (max-width:768px){
    h1{font-size:1.3rem}
  }
  
  .subtitle{
    font-size:1.1rem;
    color:var(--text-secondary);
  }
  .adkani{
    font-size:0.9rem;
    color:var(--text-secondary);
    margin:4px 0 0;
  }

  /* Stepper */
  .steps{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:8px;
    margin:16px 0 10px;
  }
  @media (max-width:768px){
    .steps{gap:4px;margin:12px 0 8px}
  }
  
  .step{
    position:relative;
    padding:14px 12px;
    border-radius:12px;
    background:var(--card);
    border:1px solid var(--border);
    color:var(--text-secondary);
    text-align:center;
    font-size:.9rem;
    user-select:none;
    transition: background 0.3s;
  }
  @media (max-width:768px){
    .step{padding:10px 4px;font-size:.7rem;border-radius:8px}
  }
  
  .step.active{
    background: var(--primary);
    color: var(--card);
    font-weight: bold;
  }
  
  /* Panels */
  .panel{
    position:relative;
    border-radius:16px;
    background: var(--card);
    border:1px solid var(--border);
    padding:24px;
    display:none;
    opacity: 0;
    transform: translateY(12px);
    transition: opacity .35s, transform .35s;
  }
  @media (max-width:768px){
    .panel{padding:16px;border-radius:12px}
  }
  
  .panel.show{
    display:block;
    opacity: 1;
    transform: translateY(0);
  }
  .grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:20px;
  }
  @media (max-width:900px){
    .grid{grid-template-columns:1fr}
  }
  
  label{
    display:block;
    font-size:1rem;
    color:var(--text-secondary);
    margin-bottom:8px;
  }
  @media (max-width:768px){
    label{font-size:.9rem}
  }
  
  .input{
    width:100%;
    padding:14px;
    border-radius:8px;
    border:1px solid var(--border);
    background:var(--bg);
    color:var(--text-primary);
    font-size:1rem;
    outline:none;
    transition:border-color .2s, box-shadow .2s;
  }
  .input:focus{
    border-color:var(--primary);
    box-shadow:0 0 0 3px var(--ring);
  }
  .help{
    font-size:.85rem;
    color:var(--text-secondary);
    margin-top:8px;
  }
  @media (max-width:768px){
    .help{font-size:.8rem}
  }
  
  .row{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
  }
  @media (max-width:768px){
    .row{gap:6px}
  }
  
  .btn{
    padding:14px 24px;
    border:none;
    border-radius:8px;
    background:var(--primary);
    color:var(--card);
    font-weight:700;
    cursor:pointer;
    transition:transform .1s ease, box-shadow .2s;
    box-shadow:0 8px 18px rgba(74, 222, 128, 0.2);
    font-size:1rem;
  }
  @media (max-width:768px){
    .btn{padding:12px 16px;font-size:.9rem}
  }
  
  .btn:hover{
    transform:translateY(-2px);
    box-shadow:0 10px 20px rgba(74, 222, 128, 0.3);
  }
  .btn:active{transform:translateY(1px)}
  .btn.secondary{
    background:var(--secondary);
    color:var(--text-primary);
    border:1px solid var(--border);
    box-shadow:none;
  }
  .btn.ghost{
    background:transparent;
    border:1px dashed var(--border);
    color:var(--text-secondary);
    box-shadow: none;
  }
  .stack{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items: center;
  }
  .spacer{height:20px}
  .pill{
    padding:10px 16px;
    border-radius:999px;
    background:var(--bg);
    border:1px solid var(--border);
    color:var(--text-primary);
    font-size:.9rem;
    cursor: pointer;
    transition: background 0.2s, border-color 0.2s;
  }
  .pill:hover{
    background: rgba(255,255,255,0.05);
  }
  .pill input{
    display: none;
  }
  .pill input:checked + span {
    color: var(--primary);
    font-weight: 700;
  }
  .note{
    font-size:.9rem;
    color:var(--text-secondary);
  }
  
  .mono{
    font-family: 'JetBrains Mono', monospace;
    text-align: right;
    direction: ltr;
  }
  .kpi{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
    gap:16px;
    margin-top:20px;
  }
  @media (max-width:768px){
    .kpi{gap:12px}
  }
  
  .kpi .card{
    background:var(--bg);
    border:1px solid var(--border);
    border-radius:12px;
    padding:18px;
  }
  @media (max-width:768px){
    .kpi .card{padding:14px}
  }
  
  .kpi .title{
    font-size:.85rem;
    color:var(--text-secondary);
  }
  .kpi .value{
    font-size:1.4rem;
    margin-top:8px;
    font-weight:700;
  }
  
  /* Table */
  table{
    width:100%;
    border-collapse:separate;
    border-spacing:0;
    margin-top:16px;
  }
  thead th{
    position:sticky;
    top:0;
    background:var(--bg);
    border-bottom:1px solid var(--border);
    padding:14px;
    font-size:.9rem;
    color:var(--text-secondary);
    z-index:1;
  }
  tbody td{
    border-bottom:1px dashed var(--border);
    padding:12px;
    color:var(--text-primary);
  }
  tbody tr:hover{
    background:rgba(255,255,255,0.05);
  }
  .td-num{
    font-family: 'JetBrains Mono', monospace;
    text-align:left;
    direction:ltr;
  }
  
  .input-num{
    width:100%;
    padding:10px;
    border-radius:8px;
    border:1px solid var(--border);
    background:var(--bg);
    color:var(--text-primary);
    direction:ltr;
    text-align:left;
  }

  /* Pie Chart */
  .pie-wrap{
    display:flex;
    gap:40px;
    align-items:center;
    justify-content:center;
    flex-wrap:wrap;
    margin-top:20px;
  }
  .pie-chart{
    width:240px;
    height:240px;
    background: conic-gradient(var(--primary) 0%, var(--primary) var(--taxable-angle), var(--text-secondary) var(--taxable-angle), var(--text-secondary) 100%);
    border-radius: 50%;
    position: relative;
  }
  .pie-chart:before{
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 80%;
    height: 80%;
    background: var(--card);
    border-radius: 50%;
    transform: translate(-50%, -50%);
  }
  .legend{
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .legend .item{
    display:flex;
    align-items:center;
    gap:10px;
  }
  .swatch{
    width:18px;
    height:18px;
    border-radius:4px;
  }
  .swatch.taxable{background:var(--primary)}
  .swatch.exempt{background:var(--text-secondary)}

  /* Alerts */
  .alert{
    border:1px solid var(--border);
    background:var(--bg);
    border-radius:12px;
    padding:16px;
    font-size:.95rem;
    line-height: 1.5;
  }
  .alert.ok{
    border-color: rgba(74, 222, 128, 0.35);
    background: rgba(74, 222, 128, 0.08);
  }
  .alert.warn{
    border-color:rgba(245,158,11,.35);
    background:rgba(245,158,11,.08);
  }
  .alert.danger{
    border-color:rgba(239,68,68,.35);
    background:rgba(239,68,68,.08);
  }

  .footer-note{
    margin-top:20px;
    color:var(--text-secondary);
    font-size:.85rem;
    text-align: center;
  }
</style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div>
          <h1>סימולטור פריסת מענק פרישה</h1>
          <div class="subtitle">חישוב לפי סעיף 8ג' לפקודת מס הכנסה</div>
          <div class="adkani">עדכני לנתוני רשות המיסים לשנת 2025</div>
        </div>
      </div>
    </header>

    <div class="steps">
      <div class="step active" data-step="1">1. נתונים ראשוניים</div>
      <div class="step" data-step="2">2. תוצאות בסיס</div>
      <div class="step" data-step="3">3. העדפות פריסה</div>
      <div class="step" data-step="4">4. סיכום וחיסכון</div>
    </div>

    <section class="panel show" id="panel-1">
      <div class="grid">
        <div>
          <label>מענק פרישה למשיכה (סה"כ)</label>
          <input class="input money" id="grantTotal" inputmode="numeric" placeholder="לדוגמה: 250,000" />
          <div class="help">סכום המענק הכולל לפני פטור/פריסה.</div>
        </div>
        <div>
          <label>שכר אחרון (חודשי ברוטו)</label>
          <input class="input money" id="lastSalary" inputmode="numeric" placeholder="לדוגמה: 12,500" />
          <div class="help">משמש לחישוב תקרת השכר הפטור.</div>
        </div>
        <div>
          <label>תאריך תחילת עבודה</label>
          <input class="input" id="startDate" type="date" />
          <div class="help">משמש לחישוב הוותק בעבודה.</div>
        </div>
        <div>
          <label>תאריך פרישה</label>
          <input class="input" id="retireDate" type="date" />
          <div class="help">התאריך בו עזבת את מקום העבודה.</div>
        </div>
        <div>
          <label>הכנסות נוספות בשנה הראשונה</label>
          <input class="input money" id="firstYearIncome" inputmode="numeric" placeholder="לדוגמה: 120,000" />
          <div class="help">הכנסות אחרות בשנת הפרישה (ללא המענק).</div>
        </div>
      </div>

      <div class="spacer"></div>
      <div class="stack">
        <button class="btn" id="to-step-2">המשך לתוצאות בסיס</button>
        <button class="btn ghost" id="resetAll" onclick="resetAll()">אפס הכל</button>
      </div>
    </section>

    <section class="panel" id="panel-2">
      <div class="kpi">
        <div class="card">
          <div class="title">ותק בעבודה (שנים)</div>
          <div class="value mono" id="kpi-tenure">0.00</div>
        </div>
        <div class="card">
          <div class="title">מענק פטור ממס</div>
          <div class="value mono" id="kpi-exempt">0.00 ש"ח</div>
        </div>
        <div class="card">
          <div class="title">מענק חייב במס</div>
          <div class="value mono" id="kpi-taxable">0.00 ש"ח</div>
        </div>
      </div>

      <div class="pie-wrap">
        <div class="pie-chart" style="--taxable-angle: 0deg;"></div>
        <div class="legend">
          <div class="item"><span class="swatch exempt"></span> פטור ממס</div>
          <div class="item"><span class="swatch taxable"></span> חייב במס</div>
        </div>
      </div>
      
      <div class="spacer"></div>
      <div class="alert warn" id="capNote" style="display:none"></div>

      <div class="spacer"></div>
      <div class="stack">
        <button class="btn secondary goBack" data-back="1">חזרה</button>
        <button class="btn" id="to-step-3">המשך להעדפות פריסה</button>
      </div>
    </section>

    <section class="panel" id="panel-3">
      <div class="grid">
        <div>
          <label>מין ונקודות זיכוי</label>
          <div class="row">
            <label class="pill"><input type="radio" name="gender" value="male" checked /><span>גבר</span></label>
            <label class="pill"><input type="radio" name="gender" value="female" /><span>אישה</span></label>
          </div>
          <div class="help">שווי נקודת זיכוי לשנת 2025: 2,904 ש"ח.</div>
        </div>
        <div>
          <label>כיוון פריסה</label>
          <div class="row">
            <label class="pill"><input type="radio" name="direction" value="forward" checked onchange="addYearsOptions()" /><span>קדימה</span></label>
            <label class="pill"><input type="radio" name="direction" value="backward" onchange="addYearsOptions()" /><span>אחורה</span></label>
          </div>
          <div class="help">אפשרות לפריסה עד 6 שנים או לפי חישוב הזכאות.</div>
        </div>
        <div>
          <label>שנות פריסה (בחר בין 1 למקסימום)</label>
          <select class="input" id="yearsSelect"></select>
          <div class="help" id="eligibilityText">זכאות תתעדכן אוטומטית.</div>
        </div>
      </div>
      
      <div class="spacer"></div>
      <div class="alert ok" id="eligibilityAlert" style="display:none"></div>

      <div class="spacer"></div>
      <div class="stack">
        <button class="btn secondary goBack" data-back="2">חזרה</button>
        <button class="btn" id="to-step-4">הצג סיכום וחיסכון</button>
      </div>
    </section>

    <section class="panel" id="panel-4">
      <div class="kpi">
        <div class="card">
          <div class="title">מס על המענק ללא פריסה</div>
          <div class="value mono" id="sum-tax-no-spread">0.00 ש"ח</div>
        </div>
        <div class="card">
          <div class="title">סך מס על המענק בפריסה</div>
          <div class="value mono" id="sum-tax-with-spread">0.00 ש"ח</div>
        </div>
        <div class="card">
          <div class="title">חיסכון במס בזכות הפריסה</div>
          <div class="value mono" id="sum-savings">0.00 ש"ח</div>
        </div>
        <div class="card">
          <div class="title">שנות פריסה שנבחרו</div>
          <div class="value mono" id="sum-years">0</div>
        </div>
      </div>

      <div class="spacer"></div>
      <div style="overflow:auto;border:1px solid var(--border);border-radius:12px">
        <table id="spreadTable">
          <thead>
            <tr>
              <th style="width:70px">שנה</th>
              <th>הכנסה נוספת</th>
              <th>חלק המענק</th>
              <th>מס על החלק</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="spacer"></div>
      <div class="alert ok">
        החישוב מבוסס על הנתונים שהזנת. מומלץ תמיד להתייעץ עם איש מקצוע.
      </div>

      <div class="spacer"></div>
      <div class="stack">
        <button class="btn secondary goBack" data-back="3">חזרה</button>
        <button class="btn ghost" id="restart">התחל מחדש</button>
      </div>
    </section>

  </div>

<script>
const INCOME_TAX_BRACKETS = [
    { limit: 84120, rate: 0.10 },
    { limit: 120720, rate: 0.14 },
    { limit: 193800, rate: 0.20 },
    { limit: 269280, rate: 0.31 },
    { limit: 560280, rate: 0.35 },
    { limit: 721560, rate: 0.47 },
    { limit: Infinity, rate: 0.50 }
  ];
const CREDIT_POINTS = { male: 2.25, female: 2.75 };
const DEFAULT_SALARY_CAP = 13750;
const CREDIT_POINT_VALUE = 2904;

function fmtMoney(v) {
    if (isNaN(v) || v == null) v = 0;
    return v.toLocaleString('he-IL', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) + " ש\"ח";
}
function fmtNum(v) {
    if (isNaN(v) || v == null) v = 0;
    return v.toLocaleString('he-IL', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}
function parseNum(el) {
    const raw = (typeof el === "string") ? el : el.value;
    const clean = raw.replace(/[^\d]/g, "");
    return parseFloat(clean) || 0;
}

function calcTax(income, gender) {
    let tax = 0, prev = 0;
    for (const b of INCOME_TAX_BRACKETS) {
        if (income > prev) {
            const taxable = Math.min(income, b.limit) - prev;
            tax += taxable * b.rate;
            prev = b.limit;
        } else break;
        if (income <= prev) break;
    }
    const credits = (CREDIT_POINTS[gender] || 0) * CREDIT_POINT_VALUE;
    return Math.max(0, tax - credits);
}

function showPanel(n) {
    document.querySelectorAll(".panel").forEach(p => p.classList.remove("show"));
    document.querySelector("#panel-" + n).classList.add("show");
    
    document.querySelectorAll(".step").forEach(s => s.classList.remove("active"));
    document.querySelector('.step[data-step="' + n + '"]').classList.add("active");
}

function calcBase() {
    const grantTotal = parseNum(document.querySelector("#grantTotal"));
    const lastSalary = parseNum(document.querySelector("#lastSalary"));
    const salaryCap = DEFAULT_SALARY_CAP;
    const start = new Date(document.querySelector("#startDate").value);
    const retire = new Date(document.querySelector("#retireDate").value);
    
    if (isNaN(start) || isNaN(retire)) return null;

    const tenureYears = (retire - start) / (1000 * 60 * 60 * 24 * 365);
    const basePerYear = Math.min(lastSalary * 1.5, salaryCap);
    const exempt = Math.min(grantTotal, tenureYears * basePerYear);
    const taxable = Math.max(0, grantTotal - exempt);

    document.querySelector("#kpi-tenure").textContent = fmtNum(tenureYears);
    document.querySelector("#kpi-exempt").textContent = fmtMoney(exempt);
    document.querySelector("#kpi-taxable").textContent = fmtMoney(taxable);

    drawPie(exempt, taxable);
    return { grantTotal, tenureYears, exempt, taxable };
}

function drawPie(exempt, taxable) {
    const total = exempt + taxable || 1;
    const taxablePct = (taxable / total) * 100;
    document.querySelector(".pie-chart").style.setProperty('--taxable-angle', `${taxablePct}%`);
}

function buildTable(data, gender, years) {
    const tbody = document.querySelector("#spreadTable tbody");
    tbody.innerHTML = "";
    
    if (data.taxable === 0) {
        document.querySelector("#sum-tax-with-spread").textContent = fmtMoney(0);
        document.querySelector("#sum-savings").textContent = fmtMoney(0);
        return;
    }

    const partPerYear = data.taxable / years;
    const retireDate = new Date(document.querySelector("#retireDate").value);
    const firstYear = retireDate.getFullYear();
    const firstIncome = parseNum(document.querySelector("#firstYearIncome"));
    const direction = document.querySelector('input[name="direction"]:checked').value;
    
    for (let i = 0; i < years; i++) {
        let y = (direction === 'forward') ? firstYear + i : firstYear - i;

        const tr = document.createElement("tr");
        
        const additionalIncome = (i === 0) ? firstIncome : 0;
        
        tr.innerHTML = `
          <td>${y}</td>
          <td><input class="input-num money" data-year="${y}" value="${additionalIncome.toLocaleString('he-IL')}" /></td>
          <td class="td-num">${fmtMoney(partPerYear)}</td>
          <td class="td-num" data-tax-for-year="${y}">${fmtMoney(0)}</td>
        `;
        tbody.appendChild(tr);
    }
    
    document.querySelectorAll('#spreadTable .input-num').forEach(input => {
        input.addEventListener('input', (e) => {
          formatInput(e);
          calcTable();
        });
    });

    calcTable();
}

function calcTable() {
    const d = calcBase();
    if (!d) return;

    const gender = document.querySelector("input[name=gender]:checked").value;
    const years = parseInt(document.querySelector("#yearsSelect").value) || 1;
    const partPerYear = d.taxable / years;
    let sumTaxWithSpread = 0;

    document.querySelectorAll("#spreadTable tbody tr").forEach(tr => {
        const year = tr.querySelector("td").textContent;
        const input = tr.querySelector(".input-num");
        const additionalIncome = parseNum(input);

        const totalIncome = additionalIncome + partPerYear;
        const taxWith = calcTax(totalIncome, gender);
        const taxWithout = calcTax(additionalIncome, gender);
        const taxOnPart = Math.max(0, taxWith - taxWithout);

        document.querySelector(`[data-tax-for-year="${year}"]`).textContent = fmtMoney(taxOnPart);
        sumTaxWithSpread += taxOnPart;
    });

    const firstIncome = parseNum(document.querySelector("#firstYearIncome"));
    const noSpreadTax = Math.max(0, calcTax(d.taxable + firstIncome, gender) - calcTax(firstIncome, gender));
    
    document.querySelector("#sum-tax-no-spread").textContent = fmtMoney(noSpreadTax);
    document.querySelector("#sum-tax-with-spread").textContent = fmtMoney(sumTaxWithSpread);
    document.querySelector("#sum-savings").textContent = fmtMoney(noSpreadTax - sumTaxWithSpread);
    document.querySelector("#sum-years").textContent = years;
}

function addYearsOptions() {
    const tenureYears = Number(document.querySelector("#kpi-tenure").textContent) || 0;
    const direction = document.querySelector('input[name="direction"]:checked').value;
    let maxYears;
    
    if (direction === 'forward') {
        maxYears = Math.min(6, Math.floor(tenureYears / 4));
    } else { // backward
        maxYears = Math.min(6, Math.floor(tenureYears));
    }
    
    const sel = document.querySelector("#yearsSelect");
    sel.innerHTML = "";
    if (maxYears > 0) {
        for (let i = 1; i <= maxYears; i++) {
            const opt = document.createElement("option");
            opt.value = i;
            opt.textContent = i;
            sel.appendChild(opt);
        }
        document.querySelector("#eligibilityText").textContent = `זכאות לפריסה: עד ${maxYears} שנים.`;
        document.querySelector("#eligibilityAlert").style.display = "block";
        document.querySelector("#eligibilityAlert").className = "alert ok";
        document.querySelector("#eligibilityAlert").textContent = `יש לך זכאות לפרוס את המענק על פני עד ${maxYears} שנים.`;
        document.querySelector("#to-step-4").disabled = false;
    } else {
        document.querySelector("#eligibilityAlert").style.display = "block";
        document.querySelector("#eligibilityAlert").className = "alert danger";
        document.querySelector("#eligibilityAlert").textContent = "אין זכאות לפריסה, המענק חייב במס בשנה הנוכחית.";
        document.querySelector("#to-step-4").disabled = true;
    }
}

document.querySelector("#to-step-2").onclick = () => {
    const requiredFields = ["#grantTotal", "#lastSalary", "#startDate", "#retireDate", "#firstYearIncome"];
    for (const selector of requiredFields) {
        const el = document.querySelector(selector);
        if (el.value.trim() === "") {
            Swal.fire({
                title: "שגיאה",
                text: "יש למלא את כל השדות כדי להמשיך.",
                icon: "error",
                confirmButtonText: "הבנתי"
            });
            el.focus();
            return;
        }
    }
    const d = calcBase();
    if(d) showPanel(2);
};

document.querySelector("#to-step-3").onclick = () => {
    const d = calcBase();
    if (d.taxable === 0) {
        Swal.fire({
            title: "אין צורך בפריסה",
            text: "המענק כולו פטור ממס. אין צורך לבצע פריסה.",
            icon: "info",
            confirmButtonText: "הבנתי"
        });
        document.querySelector("#to-step-4").disabled = true;
        return;
    }
    addYearsOptions();
    showPanel(3);
};

document.querySelector("#to-step-4").onclick = () => {
    const d = calcBase();
    const gender = document.querySelector("input[name=gender]:checked").value;
    const years = parseInt(document.querySelector("#yearsSelect").value) || 1;
    buildTable(d, gender, years);
    showPanel(4);
};

document.querySelectorAll(".goBack").forEach(b => b.onclick = () => {
    showPanel(b.dataset.back);
});

document.querySelector("#restart").onclick = () => {
    location.reload();
};

function formatInput(e) {
  const input = e.target;
  const value = input.value.replace(/[^\d]/g, '');
  if (!value) {
    input.value = '';
    return;
  }
  const formattedValue = new Intl.NumberFormat('he-IL').format(value);
  input.value = formattedValue;
}

document.querySelectorAll('.money').forEach(input => {
  input.addEventListener('input', formatInput);
});

document.querySelector('#yearsSelect').addEventListener('change', () => {
  const d = calcBase();
  const gender = document.querySelector("input[name=gender]:checked").value;
  const years = parseInt(document.querySelector("#yearsSelect").value) || 1;
  buildTable(d, gender, years);
});

</script>
<div class="footer-note">כל הזכויות שמורות. החישוב אינו מהווה ייעוץ פיננסי או משפטי.</div>
</body>
</html>
